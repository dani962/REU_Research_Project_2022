---
title: "Statistical Analysis of Fire Incidents"
author: "Danielle Mirzaeian, Nahom Fisseha"
date: '2022-06-22'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loading necessary packages

```{r}
library(readr)
library(lubridate)
library(ggplot2)
library(dslabs)
library(dplyr)
library(ggrepel)
library(ggthemes)
```

### Loading the dataset
```{r}
gso.fire <- read_csv("Greensboro_Fire_Incidents.csv")
```


### Filtering for incidents prior to June 1st 2022
```{r}
gso.fire = 
  gso.fire %>%
  mutate(AlarmDate2 = make_date(Year, Month, Day)) %>%
  filter(AlarmDate2 < '2022-06-01')
```

### Filter for property type 1-2 family dwellings
```{r}
gso.fire = gso.fire %>%
  filter(PropertyUse == '419 - 1 or 2 family dwelling')
```

### Convert to call process time to seconds and add to gso.fire
```{r}
gso.fire = gso.fire %>%
  mutate(call_process_period = lubridate::hms(CallProcessingTime), 
         call_process_seconds = period_to_seconds(call_process_period))
```

### Convert response time to seconds and add to gso.fire
```{r}
gso.fire = gso.fire %>%
  mutate(response_time_period = lubridate::hms(ResponseTime),
         response_time_seconds = period_to_seconds(response_time_period))
```

### Convert total response time to seconds and add to gso.fire
```{r}
gso.fire = gso.fire %>%
  mutate(total_response_period = lubridate::hms(TotalResponseTime),
         total_response_seconds = period_to_seconds(total_response_period))
```

### Cutoff point for total response time
```{r}
cutoff.total_response_time = gso.fire %>% select(total_response_seconds) %>% 
  filter(!is.na(total_response_seconds)) %>%
  summarize(c = quantile(total_response_seconds, .75) + 3 * IQR(total_response_seconds)) %>%
  pull(c)
```

## Histogram of distribution of total response time
```{r}
gso.fire %>%
  filter(total_response_seconds < cutoff.total_response_time) %>%
  ggplot(aes(x = total_response_seconds)) +
  geom_histogram(aes(x = total_response_seconds, fill = "red"), show.legend = FALSE, color = "black") +
  xlab("Total Response Time (Seconds)") +
  ylab("Count") +
  ggtitle("Distribution of Total Response Time") +
  theme_economist()
```

## Histogram of frequency of fire alarms by alarm hour
```{r}
gso.fire %>%
  ggplot(aes(x = AlarmHour)) +
  geom_bar(color = "black", fill = "pink") +
  scale_x_continuous(breaks = seq(0,23,1)) +
  theme(axis.text.x = element_text(angle = 45)) +
  xlab("Alarm Hour") +
  ylab("Count") +
  ggtitle("Frequency of Fire Alarms by Alarm Hour")
```

## Bar graph of frequency of calls by fire station
```{r}
gso.fire %>%
  count(station) %>%
  mutate(station = reorder(station, n)) %>%
  ggplot(aes(x = station, y = n)) +
  geom_bar(stat = "identity", color = "black", fill = "pink") +
  theme(axis.text.y = element_text(size = 6)) +
  xlab("Fire Station (Station Number)") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Fire Station") +
  coord_flip()
```

## Bar graph of frequency of calls by fire district
```{r}
gso.fire %>%
  count(FireDistrict) %>%
  mutate(FireDistrict = reorder(FireDistrict, n)) %>%
  ggplot(aes(x = FireDistrict, y = n)) +
  geom_bar(stat = "identity", color = "black", fill = "pink") +
  theme(axis.text.y = element_text(size = 6)) +
  xlab("Fire Station (Station Number)") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Fire Station") +
  coord_flip()
```

## Bar graph of frequency of calls by year
```{r}
gso.fire %>%
  count(Year) %>%
  mutate(Year = reorder(Year, n)) %>%
  ggplot(aes(x = Year, y = n)) +
  geom_bar(stat = "identity", color = "black", fill = "light blue") +
  xlab("Year") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Year")
```

## Bar graph of frequency of calls by shift
```{r}
gso.fire %>%
  ggplot(aes(x = shift)) +
  geom_bar(aes(fill = shift), color = "black", show.legend = FALSE) +
  xlab("Shift") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Shift")
```

## Box plot of days of the week vs total response time
```{r}
gso.fire %>%
  filter(total_response_seconds < cutoff.total_response_time) %>%
  ggplot(aes(x = DayOfWeek, y = total_response_seconds, fill = DayOfWeek)) +
  geom_boxplot() +
  xlab("Days of the Week") +
  ylab("Total Response Time (Seconds)") +
  ggtitle("Days of the Week vs Total Repsonse Time") +
  theme_economist()
```

## Box plot of week vs total response time
```{r}
gso.fire %>%
  filter(total_response_seconds < cutoff.total_response_time) %>%
  ggplot(aes(x = Week, y = total_response_seconds, group = Week)) +
  geom_boxplot() +
  xlab("Week") +
  ylab("Total Response Time (Seconds)") +
  ggtitle("Week vs Total Response Time") +
  theme_economist()
```

## Box plot of year vs total response time
```{r}
gso.fire %>%
  filter(total_response_seconds < cutoff.total_response_time) %>%
  ggplot(aes(x = Year, y = total_response_seconds, group = Year)) +
  geom_boxplot(aes(fill = "red"), show.legend = FALSE) +
  xlab("Year") +
  ylab("Total Response Time (Seconds)") +
  ggtitle("Year vs Total Response Time")
```

## Box plot of fire district vs total response time
```{r}
gso.fire %>%
  filter(total_response_seconds < cutoff.total_response_time) %>%
  ggplot(aes(x = FireDistrict, y = total_response_seconds, fill = FireDistrict)) +
  geom_boxplot(show.legend = FALSE) +
  theme(axis.text.x = element_text(angle = 90)) +
  xlab("Fire District") +
  ylab("Total Response Time (Seconds)") +
  ggtitle("Fire District vs Total Response Time")
```

## Box plot of work shift vs total response time
```{r}
gso.fire %>%
  filter(total_response_seconds < cutoff.total_response_time) %>%
  ggplot(aes(x = shift, y = total_response_seconds, fill = shift)) +
  geom_boxplot() +
  xlab("Work shift") +
  ylab("Total Response Time (Seconds)") +
  ggtitle("Work Shift vs Total Response Time") +
  theme_economist()
```

## Box plot of month vs total response time
```{r}
gso.fire %>%
  filter(total_response_seconds < cutoff.total_response_time) %>%
  ggplot(aes(x = Month, y = total_response_seconds, fill = Month)) +
  geom_boxplot(show.legend = FALSE) +
  xlab("Month") +
  ylab("Total Response Time (Seconds)") +
  ggtitle("Month vs Total Response Time")
```

## Box plot of station vs total response time
```{r}
gso.fire %>%
  filter(total_response_seconds < cutoff.total_response_time) %>%
  ggplot(aes(x = station, y = total_response_seconds)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90)) +
  xlab("Station") +
  ylab("Total Response Time (Seconds)") +
  ggtitle("Station vs Total Response Time")
```

## Box plot of alarm hour vs total response time
```{r}
gso.fire %>%
  filter(total_response_seconds < cutoff.total_response_time) %>%
  ggplot(aes(x = AlarmHour, y = total_response_seconds, group = AlarmHour)) +
  geom_boxplot() +
  xlab("Alarm Hour") +
  ylab("Total Response Time (Seconds)") +
  ggtitle("Alarm Hour vs Total Response Time")
```

## Box plot of number of alarms vs total response time
```{r}
gso.fire %>%
  filter(total_response_seconds < cutoff.total_response_time) %>%
  ggplot(aes(x = NumberOfAlarms, y = total_response_seconds, group = NumberOfAlarms)) +
  geom_boxplot() +
  xlab("Number of Alarms") +
  ylab("Total Response Time (Seconds)") +
  ggtitle("Number of Alarms vs Total Response Time")
```

## Box plot of nature code vs total response time
```{r}
gso.fire %>%
  filter(total_response_seconds < cutoff.total_response_time) %>%
  ggplot(aes(x =  NatureCode, y = total_response_seconds)) +
  theme(axis.text.x = element_text(angle = 90)) +
  geom_boxplot() +
  xlab("Nature Code") +
  ylab("Total Response Time (Seconds)") +
  ggtitle("Nature Code vs Total Response Time")
```

## Scatter plot of Total Staff on Incident vs Total Response
```{r}
gso.fire %>%
  filter(total_response_seconds < cutoff.total_response_time) %>%
  ggplot(aes(x = total_response_seconds, y = TotalStaffOnIncident, fill = total_response_seconds)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Total Staff On Incident") +
  xlab("Total Response Time") +
  ggtitle("Total Staff on Incident vs Total Response Time") +
  theme_economist()
```

## Scatter plot of Civilian Injuries vs Total Response Time
```{r}
gso.fire %>%
  filter(total_response_seconds < cutoff.total_response_time) %>%
  ggplot(aes(x = total_response_seconds, y = CivilianInjuries, fill = total_response_seconds)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Civilian Injuries") +
  xlab("Total Response Time") +
  ggtitle("Civilian Injuries vs Total Response Time") +
  theme_economist() 
```

## Scatter Plot for Civilian Fatalities vs Total Response Time
```{r}
gso.fire %>%
  filter(total_response_seconds < cutoff.total_response_time) %>%
  ggplot(aes(x = total_response_seconds, y = CivilianFatalities, fill = total_response_seconds)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Civilian Fatalities") +
  xlab("Total Response Time") +
  ggtitle("Civilian Fatalities vs Total Response Time") + 
  theme_economist()
```

## Scatter Plot for Fire Service Injuries vs Total Response Time
```{r}
gso.fire %>%
  filter(total_response_seconds < cutoff.total_response_time) %>%
  ggplot(aes(x = total_response_seconds, y = FireServiceInjuries, fill = total_response_seconds)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Fire Service Injuries") +
  xlab("Total Response Time") +
  ggtitle("Fire Service Injuries Injuries vs Total Response Time") +
  theme_economist()
```

## Scatter Plot for Fire Service Fatalities vs Total Response Time
```{r}
gso.fire %>%
  filter(total_response_seconds < cutoff.total_response_time) %>%
  ggplot(aes(x = total_response_seconds, y = FireServiceFatalities, fill = TotalResponseTime)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Fire Service Fatalities") +
  xlab("Total Response Time") +
  ggtitle("Fire Service Fatalities vs Total Response Time") +
  theme_economist() 
```



