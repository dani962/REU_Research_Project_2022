---
title: "Statistical Analysis of Fire Incidents in the City of Greensboro, NC"
author: "Danielle Mirzaeian, Nahom Fisseha"
date: '2022-06-22'
output: html_document
---

```{r setup, echo= FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction
Many calls are made to fire departments all the time. Whether it is a false alarm or not, it is important for first responders to take care of fire incidents as soon as possible.

There are all kinds of fire incidents, some not even about fires. For example someone could be having a stroke and the local fire department was called to take action on the situation. If the incident is a fire, it could be at all kinds of different properties. Some different properties are small houses, apartment buildings, and highways. The fire could vary in size, like the wildfires in California.

No matter the type of fire incident. It is vital that first responders attend to the situation quickly. Now, there can be some factors that can affect the response time of the first responders.
Some of those factors are the location, the type of property, and the type of the incident.

For more than ten years, the city of Greensboro, NC has been collecting data on fire incidents in their area. Some of this data includes the date of the incident, the response time, the location, and the type of property. Yet, take note when looking at the data that it goes from July 1, 2010, to Jun 1, 2022. So for the years 2010 and 2022, only data for about half of those years was collected.

For this project we will be visualizing the fire incidents in Greensboro, NC. Our research questions are 1) What factors affect the response time to fire incidents? 2) How to improve the response time? 3) How does response time by fire emergency services affect the rate of total loss and civilian injuries? 4)Can we build models to forecast the number of fire incidents in certain areas of Greensboro based on the data from 2010 to 2022? 5) what Dynamic models can we make for forecasting fire incidents?

## Related Literature
https://www.researchgate.net/publication/316976331_Modelling_residential_fire_incident_response_times_A_spatial_analytic_approach

https://www.researchgate.net/publication/226273683_The_Relationships_Between_Fire_Service_Response_Time_and_Fire_Outcomes

https://www.researchgate.net/publication/333158843_Statistical_Analysis_of_Fire_Department_Response_Times_and_Effects_on_Fire_Outcomes_in_the_United_States (need to request) 


## Data, Method, and Analysis

### Data
For this analysis, we utilized public data from the Greensboro Fire Department. This data set accounts for all reported fire incidents in the city of Greensboro from July of 2010 until the most recent report. 

### Method

#### Exploratory Data Analysis
The first step in our research project was exploratory data analysis. During this process we investigated the data looking for patterns and outliers. This was carried out by making various graphical representations of the data.


```{r, message=FALSE, warning=FALSE, echo=FALSE}
library(readr)
library(lubridate)
library(ggplot2)
library(dslabs)
library(dplyr)
library(ggrepel)
library(ggthemes)
library(broom)
```


```{r, message=FALSE, warning=FALSE, echo = FALSE}
gso.fire <- read_csv("Greensboro_Fire_Incidents.csv")
```


```{r, echo = FALSE}
gso.fire = 
  gso.fire %>%
  mutate(AlarmDate2 = make_date(Year, Month, Day)) %>%
  filter(AlarmDate2 < '2022-06-01')
```


```{r, echo = FALSE}
gso.fire = gso.fire %>%
  filter(PropertyUse == '419 - 1 or 2 family dwelling')
```


```{r, echo = FALSE}
gso.fire = gso.fire %>%
  mutate(call_process_period = lubridate::hms(CallProcessingTime), 
         call_process_seconds = period_to_seconds(call_process_period))
```


```{r, message=FALSE, warning=FALSE, echo = FALSE}
gso.fire = gso.fire %>%
  mutate(response_time_period = lubridate::hms(ResponseTime),
         response_time_seconds = period_to_seconds(response_time_period))
```


```{r, message=FALSE, warning=FALSE, echo = FALSE}
gso.fire = gso.fire %>%
  mutate(total_response_period = lubridate::hms(TotalResponseTime),
         total_response_seconds = period_to_seconds(total_response_period))
```


```{r, echo = FALSE}
cutoff.response_time = gso.fire %>% select(response_time_seconds) %>%
  filter(!is.na(response_time_seconds)) %>%
  summarize(c = quantile(response_time_seconds, .75) + 3 * IQR(response_time_seconds)) %>%
  pull(c)
```


#### Univariate Explorations
Data Visualizations consisting of one variable

```{r, message=FALSE, warning=FALSE, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = response_time_seconds, fill = "red")) +
  geom_histogram(show.legend = FALSE, color = "black") +
  xlab("Response Time (Seconds)") +
  ylab("Count") +
  ggtitle("Distribution of Response Time") +
  theme_economist()
```

For the histogram above, we learned that the typical response time falls between about 100 seconds to 400 seconds and that the distribution is normal.

```{r, echo=FALSE}
gso.fire %>%
  ggplot(aes(x = AlarmHour)) +
  geom_bar(color = "black", fill = "pink") +
  scale_x_continuous(breaks = seq(0,23,1)) +
  theme(axis.text.x = element_text(angle = 45)) +
  xlab("Alarm Hour") +
  ylab("Count") +
  ggtitle("Frequency of Fire Alarms by Alarm Hour")
```

From this bar graph, it can be seen that the frequency of calls to the fire stations are less during the middle of the night and increase as people start waking up.


```{r, echo=FALSE}
gso.fire %>%
  count(station) %>%
  mutate(station = reorder(station, n)) %>%
  ggplot(aes(x = station, y = n)) +
  geom_bar(stat = "identity", color = "black", fill = "pink") +
  theme(axis.text.y = element_text(size = 6)) +
  xlab("Fire Station (Station Number)") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Fire Station") +
  coord_flip()
```


```{r, echo=FALSE}
gso.fire %>%
  count(FireDistrict) %>%
  mutate(FireDistrict = reorder(FireDistrict, n)) %>%
  ggplot(aes(x = FireDistrict, y = n)) +
  geom_bar(stat = "identity", color = "black", fill = "pink") +
  theme(axis.text.y = element_text(size = 6)) +
  xlab("Fire Station (Station Number)") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Fire Station") +
  coord_flip()
```


```{r, echo=FALSE}
gso.fire %>%
  count(Year) %>%
  ggplot(aes(x = Year, y = n)) +
  geom_bar(stat = "identity", fill = "pink", color = "black") +
  scale_x_continuous(breaks = seq(2010,2022,1)) +
  xlab("Year") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Year")
```



```{r, echo=FALSE}
gso.fire %>%
  ggplot(aes(x = shift)) +
  geom_bar(show.legend = FALSE, fill = "pink", color = "black") +
  xlab("Shift") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Shift")
```


```{r, echo=FALSE}
gso.fire %>%
  ggplot(aes(x = DayOfWeek)) +
  geom_bar(fill = "pink", color = "black") +
  xlab("Days of the Week") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Days of the Week")
```


```{r, echo=FALSE}
gso.fire %>%
  ggplot(aes(x = Week)) +
  geom_bar(fill = "pink", color = "black") +
  scale_x_continuous(breaks = seq(1,53,1)) +
  theme(axis.text.x = element_text(angle = 90)) +
  xlab("Week") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Week")
```


```{r, echo=FALSE}
gso.fire %>%
  ggplot(aes(x = Month)) +
  geom_bar(fill = "pink", color = "black") +
  xlab("Month") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Month")
```

#### Bivariate Explorations
Data Visualizations of a given variable vs response time


```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = Week, y = response_time_seconds, group = Week)) +
  geom_boxplot() +
  scale_x_continuous(breaks = seq(1,53,1)) +
  theme(axis.text.x = element_text(angle = 90)) +
  xlab("Week") +
  ylab("Response Time (Seconds)") +
  ggtitle("Week vs Response Time")
```



```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = station, y = response_time_seconds)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90)) +
  xlab("Station") +
  ylab("Response Time (Seconds)") +
  ggtitle("Station vs Response Time")
```



```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = NatureCode, y = response_time_seconds)) +
  theme(axis.text.x = element_text(angle = 90)) +
  geom_boxplot() +
  xlab("Nature Code") +
  ylab("Response Time (Seconds)") +
  ggtitle("Nature Code vs Response Time")
```



```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = response_time_seconds, y = TotalStaffOnIncident)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Total Staff On Incident") +
  xlab("Response Time (Seconds)") +
  ggtitle("Total Staff on Incident vs Response Time") +
  theme_economist()
```



```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = response_time_seconds, y = CivilianInjuries)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Civilian Injuries") +
  xlab("Response Time (Seconds)") +
  ggtitle("Civilian Injuries vs Response Time") +
  theme_economist() 
```


```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = response_time_seconds, y = CivilianFatalities)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Civilian Fatalities") +
  xlab("Response Time (Seconds)") +
  ggtitle("Civilian Fatalities vs Response Time") + 
  theme_economist()
```



```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = response_time_seconds, y = FireServiceInjuries)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Fire Service Injuries") +
  xlab("Response Time (Seconds)") +
  ggtitle("Fire Service Injuries Injuries vs Response Time") +
  theme_economist()
```



```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = response_time_seconds, y = FireServiceFatalities)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Fire Service Fatalities") +
  xlab("Response Time (Seconds)") +
  ggtitle("Fire Service Fatalities vs Response Time") +
  theme_economist() 
```



```{r, echo=FALSE}
gso.fire %>%
  filter(!is.na(response_time_seconds)) %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = DayOfWeek, y = response_time_seconds)) +
  geom_violin(trim = FALSE, fill = "light blue") +
  geom_boxplot(width = 0.3, fill = "pink") +
  xlab("Days of the Week") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin & Box Plot of Response Time Densities by Days of the Week") +
  theme(axis.text.x = element_text(angle = 90), legend.position = "hide")
```



```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = Year, y = response_time_seconds, group = Year)) +
  geom_violin(trim = FALSE, fill = "light blue") +
  geom_boxplot(show.legend = FALSE, width = .3, fill = "pink") +
  scale_x_continuous(breaks = seq(2010,2022,1)) +
  xlab("Year") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin & Box Plots of Response Time Densities by Year")
```



```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = shift, y = response_time_seconds)) +
  geom_violin(show.legend = FALSE, fill = "light blue") +
  geom_boxplot(width = .5, show.legend = FALSE, fill = "pink") +
  xlab("Work shift") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin and Box Plot of Response Time Densities by Work Shift")
```



```{r, message=FALSE, warning=FALSE, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = FireDistrict, y = response_time_seconds)) +
  geom_violin(fill = "light blue") +
  geom_boxplot(show.legend = FALSE, width = .2, fill = "pink") +
  theme(axis.text.x = element_text(angle = 90), legend.position = "hide") +
  xlab("Fire District") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin and Box Plot of Response Time Densities by Fire District")
```



```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = Month, y = response_time_seconds)) +
  geom_violin(show.legend = FALSE, fill = "light blue") +
  geom_boxplot(show.legend = FALSE, width = .3, fill = "pink") +
  xlab("Month") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin and Box Plot of Response Time Densities by Month")
```



```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = AlarmHour, y = response_time_seconds, group = AlarmHour)) +
  geom_violin(fill = "light blue") +
  geom_boxplot(width = .3, fill = "pink") +
  scale_x_continuous(breaks = seq(0,23,1)) +
  xlab("Alarm Hour") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin and Box Plot of Response Time Densities by Alarm Hour")
```



```{r, message=FALSE, warning=FALSE, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = NumberOfAlarms, y = response_time_seconds, group = NumberOfAlarms)) +
  geom_violin(fill = "light blue") +
  geom_boxplot(width = .3, fill = "pink") +
  xlab("Number of Alarms") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin and Box Plot of Response Time Densities by Number of Alarms")
```


### Time Series Visualization
Visualization of fire incidents in Greensboro, NC


####  Daily Time series

```{r, echo=FALSE}
gso.fire.ts = gso.fire %>%
  count(AlarmDate2)
```


```{r, echo=FALSE}
gso.fire.ts %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Year") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2010-01-01" & AlarmDate2 <= "2010-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2010")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2011-01-01" & AlarmDate2 <= "2011-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2011")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2012-01-01" & AlarmDate2 <= "2012-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2012")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2013-01-01" & AlarmDate2 <= "2013-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2013")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2014-01-01" & AlarmDate2 <= "2014-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2014")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2015-01-01" & AlarmDate2 <= "2015-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2015")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2016-01-01" & AlarmDate2 <= "2016-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2016")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2017-01-01" & AlarmDate2 <= "2017-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2017")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2018-01-01" & AlarmDate2 <= "2018-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2018")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2019-01-01" & AlarmDate2 <= "2019-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2019")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2020-01-01" & AlarmDate2 <= "2020-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2020")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2021-01-01" & AlarmDate2 <= "2021-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2021")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2022-01-01" & AlarmDate2 <= "2022-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2022")
```

#### Weekly Time Series

```{r, echo=FALSE}
gso.fire.ts.week = gso.fire %>%
  group_by(Year, Week) %>%
  count()
```


```{r, echo=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2010") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2010")
```


```{r, echo=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2011") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2011")
```


```{r, echo=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2012") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2012")
```


```{r, echo=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2013") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2013")
```


```{r, echo=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2014") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2014")
```


```{r, echo=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2015") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2015")
```


```{r, echo=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2016") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2016")
```


```{r, echo=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2017") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2017")
```


```{r, echo=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2018") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2018")
```


```{r, echo=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2019") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2019")
```


```{r, echo=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2020") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2020")
```


```{r, echo=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2021") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2021")
```


```{r, echo=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2022") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2022")
```

#### Monthly Time Series


```{r, echo=FALSE}
gso.fire.ts.month = gso.fire %>%
  group_by(Year, Month) %>%
  count()
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2010") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2010")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2011") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2011")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2012") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2012")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2013") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2013")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2014") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2014")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2015") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2015")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2016") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2016")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2017") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2017")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2018") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2018")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2019") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2019")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2020") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2020")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2021") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2021")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2022") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2022")
```


## Modeling of Response Time

```{r, echo=FALSE}
gso.fire.filtered = gso.fire %>%
  filter(response_time_seconds < cutoff.response_time)
```

```{r, echo=FALSE}
gso.fire.filtered = gso.fire.filtered %>% 
  mutate(AlarmHour = as.factor(AlarmHour))
  
```

```{r, echo=FALSE}
lm.res.time = lm(response_time_seconds ~ TotalStaffOnIncident + FireDistrict + DayOfWeek + shift + Month + AlarmHour, data = gso.fire.filtered)
```


```{r, echo=FALSE}
summary(lm.res.time)
```


```{r, echo=FALSE}
library(MASS)
lm.res.time.select = stepAIC(lm.res.time)
summary(lm.res.time.select)

```





## Appendix
This section contains the code to reproduce the analysis described in this report.

Below is a list of the libraries that we used throughout the report.

#### Loading necessary packages

```{r, message=FALSE, warning=FALSE, eval=FALSE}
library(readr)
library(lubridate)
library(ggplot2)
library(dslabs)
library(dplyr)
library(ggrepel)
library(ggthemes)
library(broom)
```

#### Data Preprocessing
```{r, message=FALSE, warning=FALSE, eval=FALSE}
gso.fire <- read_csv("Greensboro_Fire_Incidents.csv")
```


#### Filtering for incidents prior to June 1st 2022
```{r, eval=FALSE}
gso.fire = 
  gso.fire %>%
  mutate(AlarmDate2 = make_date(Year, Month, Day)) %>%
  filter(AlarmDate2 < '2022-06-01')
```

#### Filter for property type 1-2 family dwellings
```{r, eval=FALSE}
gso.fire = gso.fire %>%
  filter(PropertyUse == '419 - 1 or 2 family dwelling')
```

#### Convert to call process time to seconds and add to gso.fire
```{r, eval=FALSE}
gso.fire = gso.fire %>%
  mutate(call_process_period = lubridate::hms(CallProcessingTime), 
         call_process_seconds = period_to_seconds(call_process_period))
```

#### Convert response time to seconds and add to gso.fire
```{r, message=FALSE, warning=FALSE, eval=FALSE}
gso.fire = gso.fire %>%
  mutate(response_time_period = lubridate::hms(ResponseTime),
         response_time_seconds = period_to_seconds(response_time_period))
```

#### Convert total response time to seconds and add to gso.fire
```{r, message=FALSE, warning=FALSE, eval=FALSE}
gso.fire = gso.fire %>%
  mutate(total_response_period = lubridate::hms(TotalResponseTime),
         total_response_seconds = period_to_seconds(total_response_period))
```

#### Cutoff point for response time
```{r, eval=FALSE}
cutoff.response_time = gso.fire %>% select(response_time_seconds) %>%
  filter(!is.na(response_time_seconds)) %>%
  summarize(c = quantile(response_time_seconds, .75) + 3 * IQR(response_time_seconds)) %>%
  pull(c)
```
