---
title: "Statistical Analysis of Fire Incidents in the City of Greensboro, NC"
author: "Danielle Mirzaeian, Nahom Fisseha"
date: '2022-06-22'
output:
  html_document: default
  pdf_document: default
  word_document: default
---

```{r setup, echo= FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Abstract

## Introduction
Many calls are made to fire departments all the time. Whether it is a false alarm or not, it is important for first responders to take care of fire incidents as soon as possible. Therefore it is important to look at data about different fire incidents and see how the response time can be improved for all kinds of situations.

There are all kinds of fire incidents, some not even about fires. For example someone could be having a stroke and the local fire department was called to take action on the situation. If the incident is a fire, it could be at all kinds of different properties. Some different properties are small houses, apartment buildings, and highways. The fire could vary in size, like the wildfires in California.

No matter the type of fire incident. It is vital that first responders attend to the situation quickly. Now, there can be some factors that can affect the response time of the first responders. Some of those factors are the location, the type of property, and the type of the incident. From this project we want to explore which factors from the data have a significant affect on the response time of the fire department. By learning about these factors, the fire department could use this information to work on decreasing their response time.

For more than ten years, the city of Greensboro, NC has been collecting data on fire incidents in their area. Some of this data includes the date of the incident, the response time, the location, and the type of property. Yet, take note when looking at the data that it goes from July 1, 2010, to Jun 1, 2022. So for the years 2010 and 2022, only data for about half of those years was collected.

For this project we will be visualizing the fire incidents in Greensboro, NC. Our research questions are 1) What factors affect the response time to fire incidents? 2) How to improve the response time? 3) How does response time by fire emergency services affect the rate of total loss and civilian injuries? 4)Can we build models to forecast the number of fire incidents in certain areas of Greensboro based on the data from 2010 to 2022? 5) what Dynamic models can we make for forecasting fire incidents?


## Outro 
Although multiple studies have sought to capture the analytics behind fire incidents not many have gone completely in-depth in terms of covering fully what factors can affect response time. In this report we aim to completely cover all given factors that may effect fire service response time and how response time effects the rate of total loss in Greensboro, NC. With this information we then will create a model to forecast the next 6 month in regards to reported fire incidents.


## Data, Method, and Analysis

### Data
For this analysis, we utilized public data from the Greensboro Fire Department. This data set accounts for all reported fire incidents in the city of Greensboro from July 1st of 2010 to June 1st of 2022. Although, we noticed there were some missing values in the data. So we did a map to check the percentage of missing values and it ended being about 14 percent for the whole data set.

### Method

#### Exploratory Data Analysis
The first step in our research project was exploratory data analysis. During this process we investigated the data looking for patterns and outliers. This was carried out by making various graphical representations of the data.


```{r, message=FALSE, warning=FALSE, echo=FALSE}
library(readr)
library(lubridate)
library(ggplot2)
library(dslabs)
library(dplyr)
library(ggrepel)
library(ggthemes)
library(broom)
library(glmnet)
library(MASS)
library(tidyverse)
library(Amelia)
library(mice)
library(caret)
library(forecast)
library(urca)
library(randomForest)
```


```{r, message=FALSE, warning=FALSE, echo = FALSE}
gso.fire <- read_csv("Greensboro_Fire_Incidents.csv")
```


```{r, echo = FALSE}
gso.fire = 
  gso.fire %>%
  mutate(AlarmDate2 = make_date(Year, Month, Day)) %>%
  filter(AlarmDate2 < '2022-06-01')
```


```{r, echo = FALSE}
gso.fire = gso.fire %>%
  filter(PropertyUse == '419 - 1 or 2 family dwelling')
```


```{r, echo = FALSE}
gso.fire = gso.fire %>%
  mutate(call_process_period = lubridate::hms(CallProcessingTime), 
         call_process_seconds = period_to_seconds(call_process_period))
```


```{r, message=FALSE, warning=FALSE, echo = FALSE}
gso.fire = gso.fire %>%
  mutate(response_time_period = lubridate::hms(ResponseTime),
         response_time_seconds = period_to_seconds(response_time_period))
```


```{r, message=FALSE, warning=FALSE, echo = FALSE}
gso.fire = gso.fire %>%
  mutate(total_response_period = lubridate::hms(TotalResponseTime),
         total_response_seconds = period_to_seconds(total_response_period))
```


```{r, echo = FALSE}
cutoff.response_time = gso.fire %>% 
  dplyr::select(response_time_seconds) %>%
  filter(!is.na(response_time_seconds)) %>%
  summarize(c = quantile(response_time_seconds, .75) + 3 * IQR(response_time_seconds)) %>%
  pull(c)
```


#### Univariate Explorations
Data Visualizations consisting of one variable

```{r, message=FALSE, warning=FALSE, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = response_time_seconds, fill = "red")) +
  geom_histogram(show.legend = FALSE, color = "black") +
  xlab("Response Time (Seconds)") +
  ylab("Count") +
  ggtitle("Distribution of Response Time") +
  theme_economist()
```

For the histogram above, we learned that the typical response time falls between about 100 seconds to 400 seconds and that the distribution is normal.

```{r, echo=FALSE}
gso.fire %>%
  ggplot(aes(x = AlarmHour)) +
  geom_bar(color = "black", fill = "pink") +
  scale_x_continuous(breaks = seq(0,23,1)) +
  theme(axis.text.x = element_text(angle = 45)) +
  xlab("Alarm Hour") +
  ylab("Count") +
  ggtitle("Frequency of Fire Alarms by Alarm Hour")
```

From this bar graph, it can be seen that the frequency of calls to the fire stations are less during the middle of the night and increase as people start waking up.


```{r, echo=FALSE}
gso.fire %>%
  count(station) %>%
  mutate(station = reorder(station, n)) %>%
  ggplot(aes(x = station, y = n)) +
  geom_bar(stat = "identity", color = "black", fill = "pink") +
  theme(axis.text.y = element_text(size = 6)) +
  xlab("Fire Station (Station Number)") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Fire Station") +
  coord_flip()
```

For this graph, we wanted to find out which fire stations got the most calls. Note that the calls counted are from July 1, 2010 to Jun 1, 2022. From the results we can tell that the top five fire stations that got the most calls over ten years in Greensboro NC, was 7, 8, 14, 4, and 56.

```{r, echo=FALSE}
gso.fire %>%
  count(FireDistrict) %>%
  mutate(FireDistrict = reorder(FireDistrict, n)) %>%
  ggplot(aes(x = FireDistrict, y = n)) +
  geom_bar(stat = "identity", color = "black", fill = "pink") +
  theme(axis.text.y = element_text(size = 6)) +
  xlab("Fire Station (Station Number)") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Fire District") +
  coord_flip()
```

For this bar plot, we wanted to find out which fire districts got the most calls in Greensboro, NC over ten years. The fire districts consist of a few fire stations. The most popular fire districts from this bar plot from greatest to least were Battalion II, Battalion I and Battalion III.


```{r, echo=FALSE}
gso.fire %>%
  count(Year) %>%
  ggplot(aes(x = Year, y = n)) +
  geom_bar(stat = "identity", fill = "pink", color = "black") +
  scale_x_continuous(breaks = seq(2010,2022,1)) +
  xlab("Year") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Year")
```

From this graph, we wanted to learn if there were some years that had a significant difference in number of phone calls to the fire stations in Greensboro, NC. By looking at those differences we could explore how response time varied between years that were busier than others. Note from this graph, that only half of the data was collected for the years 2010 and 2022, so those bars will be obviously lower than the bars of other years displayed in the graph.

```{r, echo=FALSE}
gso.fire %>%
  ggplot(aes(x = shift)) +
  geom_bar(show.legend = FALSE, fill = "pink", color = "black") +
  xlab("Shift") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Shift")
```

This visual was created to look at if the number of calls to the fire station would vary depending on which shift was currently working. For this data, there were three shifts, A, B, and C. From the results, it can be seen that there is no obvious difference in the frequency of the calls to the fire station on different work shifts.

```{r, echo=FALSE}
gso.fire %>%
  ggplot(aes(x = DayOfWeek)) +
  geom_bar(fill = "pink", color = "black") +
  xlab("Days of the Week") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Days of the Week")
```

From this bar graph, it can be seen that the frequency of calls to the fire station over ten years ended up being about the same between each day of the week with no obvious differences.

```{r, echo=FALSE}
gso.fire %>%
  ggplot(aes(x = Week)) +
  geom_bar(fill = "pink", color = "black") +
  scale_x_continuous(breaks = seq(1,53,1)) +
  theme(axis.text.x = element_text(angle = 90)) +
  xlab("Week") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Week")
```

From the bar plot above, it is shown that the first week and the last week of the year typically had fewer calls to the fire station compared to other weeks in the year. This graph had a little more variability in frequency in calls. For example, the dip in the middle of the bar plot. This plot helps us to look at the busier times in the data and compare the response times.

```{r, echo=FALSE}
gso.fire %>%
  ggplot(aes(x = Month)) +
  geom_bar(fill = "pink", color = "black") +
  xlab("Month") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Month")
```

This visual was used to look further into if there was a higher frequency of calls to fire stations in certain parts of the year. From the results, June and February seem to have the lowest frequency of calls, while January and December have the highest frequency of calls. With this knowledge we can look at how response time varied with those months.


#### Bivariate Explorations
Data Visualizations of a given variable vs response time


```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = Week, y = response_time_seconds, group = Week)) +
  geom_boxplot() +
  scale_x_continuous(breaks = seq(1,53,1)) +
  theme(axis.text.x = element_text(angle = 90)) +
  xlab("Week") +
  ylab("Response Time (Seconds)") +
  ggtitle("Week vs Response Time")
```

From this box plot, we wanted to see if certain weeks would have notable differences in response time. Looking at the results, there does not seem to be much variation. Therefore, the weeks in the year might not have a significant impact on response time.

```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = station, y = response_time_seconds)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90)) +
  xlab("Station") +
  ylab("Response Time (Seconds)") +
  ggtitle("Station vs Response Time")
```

The box plot above shows that there is a lot of variability in response time depending on which station responded to the call. By looking at these results, we can explore and question why different fire stations have such big contrasts in response time.

```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = NatureCode, y = response_time_seconds)) +
  theme(axis.text.x = element_text(angle = 90)) +
  geom_boxplot() +
  xlab("Nature Code") +
  ylab("Response Time (Seconds)") +
  ggtitle("Nature Code vs Response Time")
```

For this graph above, we looked at nature code and how it affects response time. Nature code represents the nature of the fire incident, whether it was a fire or someone having a stroke. As shown by the graph, there is a lot of variability in response time depending on the nature of the fire incident.

```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = response_time_seconds, y = TotalStaffOnIncident)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Total Staff On Incident") +
  xlab("Response Time (Seconds)") +
  ggtitle("Total Staff on Incident vs Response Time") +
  theme_economist()
```

From this scatter plot, we wanted to see if the number of staff on incident would affect the response time of the fire responders. The outcome of the graph shows that there is no significant change in response time when having more people on shift. The response time still falls between 100 and 400 seconds, no matter the number of responders.

```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = response_time_seconds, y = CivilianInjuries)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Civilian Injuries") +
  xlab("Response Time (Seconds)") +
  ggtitle("Civilian Injuries vs Response Time") +
  theme_economist() 
```

For this scatter plot, we wanted to learn more about the relationship between civilian injuries and response time. From the plot, we learned that most of the time there are no civilian injuries and sometime there is one civilian injury. The response time still appears to fall into the expected range of 100 to 400 seconds, so having small numbers of civilian injuries has little effect on the response time.

```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = response_time_seconds, y = CivilianFatalities)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Civilian Fatalities") +
  xlab("Response Time (Seconds)") +
  ggtitle("Civilian Fatalities vs Response Time") + 
  theme_economist()
```

From this plot, we wanted to explore the effect civilian fatalities has on response time. As shown by the results, the majority of the time there were no civilian fatalities from the fire incidents in Greensboro, NC. Therefore, the response time is not significantly affected by this variable.

```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = response_time_seconds, y = FireServiceInjuries)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Fire Service Injuries") +
  xlab("Response Time (Seconds)") +
  ggtitle("Fire Service Injuries Injuries vs Response Time") +
  theme_economist()
```

The scatter plot above shows that there is usually no fire service injuries. But sometimes there can be one and as shown by the plot, it does not greatly affect the response time.

```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = response_time_seconds, y = FireServiceFatalities)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Fire Service Fatalities") +
  xlab("Response Time (Seconds)") +
  ggtitle("Fire Service Fatalities vs Response Time") +
  theme_economist() 
```

The plot above shows us that there never has been a fire service fatality in Greensboro, NC from the ten years of data collected. Therefore, this variable does not affect the response time.

Below, the box and violin plots had similar results to the bar graphs presented earlier. Each graph will summarize briefly what have seen before.

```{r, echo=FALSE}
gso.fire %>%
  filter(!is.na(response_time_seconds)) %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = DayOfWeek, y = response_time_seconds)) +
  geom_violin(trim = FALSE, fill = "light blue") +
  geom_boxplot(width = 0.3, fill = "pink") +
  xlab("Days of the Week") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin & Box Plot of Response Time Densities by Days of the Week") +
  theme(axis.text.x = element_text(angle = 90), legend.position = "hide")
```

For this violin and box plot, it can be seen that there is very little difference in response time between the days of the week.

```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = Year, y = response_time_seconds, group = Year)) +
  geom_violin(trim = FALSE, fill = "light blue") +
  geom_boxplot(show.legend = FALSE, width = .3, fill = "pink") +
  scale_x_continuous(breaks = seq(2010,2022,1)) +
  xlab("Year") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin & Box Plot of Response Time Densities by Year")
```

From the plot above there is a slight increase in the average response time after the year 2013 and it continues to stay the same or slightly increase more.

```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = shift, y = response_time_seconds)) +
  geom_violin(show.legend = FALSE, fill = "light blue") +
  geom_boxplot(width = .5, show.legend = FALSE, fill = "pink") +
  xlab("Work shift") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin and Box Plot of Response Time Densities by Work Shift")
```

For this graph it can be seen that different work shifts did not affect the response time.

```{r, message=FALSE, warning=FALSE, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = FireDistrict, y = response_time_seconds)) +
  geom_violin(fill = "light blue") +
  geom_boxplot(show.legend = FALSE, width = .2, fill = "pink") +
  theme(axis.text.x = element_text(angle = 90), legend.position = "hide") +
  xlab("Fire District") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin and Box Plot of Response Time Densities by Fire District")
```

As shown by the graph, the response time varies depending on which fire district responded to the fire incident.

```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = Month, y = response_time_seconds)) +
  geom_violin(show.legend = FALSE, fill = "light blue") +
  geom_boxplot(show.legend = FALSE, width = .3, fill = "pink") +
  xlab("Month") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin and Box Plot of Response Time Densities by Month")
```

For this box and violin plot, we learned that the time of month in the year has very little effect on the response time.

```{r, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = AlarmHour, y = response_time_seconds, group = AlarmHour)) +
  geom_violin(fill = "light blue") +
  geom_boxplot(width = .3, fill = "pink") +
  scale_x_continuous(breaks = seq(0,23,1)) +
  xlab("Alarm Hour") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin and Box Plot of Response Time Densities by Alarm Hour")
```

From this visual, we learned that alarm hour has a slight effect on response time, as shown by the dips in the plot.

```{r, message=FALSE, warning=FALSE, echo=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = NumberOfAlarms, y = response_time_seconds, group = NumberOfAlarms)) +
  geom_violin(fill = "light blue") +
  geom_boxplot(width = .3, fill = "pink") +
  xlab("Number of Alarms") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin and Box Plot of Response Time Densities by Number of Alarms")
```

For the graph above, there would sometimes be a couple alarms set off for a fire incident, but it did not affect the response time whether the alarm was once or twice.

### Time Series Visualization
Visualization of fire incidents in Greensboro, NC


#### Daily Time series

```{r, echo=FALSE}
gso.fire.ts = gso.fire %>%
  count(AlarmDate2)
```


```{r, echo=FALSE}
gso.fire.ts %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Year") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents")
```

Above is a time series plot of the daily number of fire incidents from July 1, 2010 to June 1st 2022. As shown by the plot, there were big spikes around 2013, 2018, and 2021.

Below is the daily time series graphs for the years 2010 to 2022.

```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2010-01-01" & AlarmDate2 <= "2010-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2010")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2011-01-01" & AlarmDate2 <= "2011-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2011")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2012-01-01" & AlarmDate2 <= "2012-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2012")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2013-01-01" & AlarmDate2 <= "2013-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2013")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2014-01-01" & AlarmDate2 <= "2014-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2014")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2015-01-01" & AlarmDate2 <= "2015-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2015")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2016-01-01" & AlarmDate2 <= "2016-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2016")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2017-01-01" & AlarmDate2 <= "2017-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2017")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2018-01-01" & AlarmDate2 <= "2018-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2018")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2019-01-01" & AlarmDate2 <= "2019-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2019")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2020-01-01" & AlarmDate2 <= "2020-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2020")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2021-01-01" & AlarmDate2 <= "2021-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2021")
```



```{r, echo=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2022-01-01" & AlarmDate2 <= "2022-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2022")
```


#### Monthly Time Series

Below are time series graphs of the monthly number of fire incidents for the years 2010 to 2022.

```{r, echo=FALSE}
gso.fire.ts.month = gso.fire %>%
  mutate(Monthly = make_date(Year, Month)) %>%
  group_by(Monthly, Month, Year) %>%
  count()
```

```{r, echo=FALSE}
gso.fire.ts.month %>%
  ggplot(aes(x = Monthly, y = n)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2010-2022")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2010") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2010")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2011") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2011")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2012") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2012")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2013") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2013")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2014") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2014")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2015") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2015")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2016") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2016")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2017") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2017")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2018") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2018")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2019") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2019")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2020") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2020")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2021") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2021")
```


```{r, echo=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2022") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2022")
```


## Results
### Time Series Forecasting

#### Forecasting for daily number of forecasting

In order to forecast the data we had to convert it into time series objects with the ts function in R studio.
```{r}
gso.fire.ts.2 <- ts(gso.fire.ts$n, start = c(2010, 182), end = c(2022, 153),
                 frequency = 365)
```


Before forecasting we checked the data for stationarity.
```{r}
acf(gso.fire.ts.2)
```

Then we did our first attempt at differencing the data.
```{r}
gso.fire.ts.2.dif = diff(gso.fire.ts.2)
acf(gso.fire.ts.2.dif)
```

```{r, echo=FALSE}
cbind("Fire Incidents" = gso.fire.ts.2,
      "First differenced" = diff(gso.fire.ts.2)) %>%
  autoplot(facets=TRUE) +
  xlab("Date") + ylab("") +
  ggtitle("Stationarity Transformations of Daily Fire Incidents")
```

#### Forecasting for monthly number of Fire Incidents

We again converted the data into a time series object inorder to use the functions for forecasting the time series data.
```{r}
gso.fire.ts.month.2 <- ts(gso.fire.ts.month$n, start = c(2010, 7), end = c(2022, 6),
                    frequency = 12)
```

Then we checked the monthly data for stationarity.
```{r}
acf(gso.fire.ts.month.2)
```

After that we did an attempt at differencing.
```{r}
gso.fire.ts.month.2.dif = diff(gso.fire.ts.month.2)
acf(gso.fire.ts.month.2.dif)
```

```{r, echo=FALSE}
cbind("Fire Incidents" = gso.fire.ts.month.2,
      "First differenced" = diff(gso.fire.ts.month.2)) %>%
  autoplot(facets=TRUE) +
  xlab("Date") + ylab("") +
  ggtitle("Stationarity Transformation of Monthly Fire Incidents")
```


## Modeling of Response Time

In this section the results of the predictive modeling of fire incidents is displayed.

There was one type of modeling done, and that was logistic regression. With this, we can evaluate the main factors that affect response time for fire incidents.

### Logistic Regression

In order to successfully depict the affect of each given variable in relation to response time the first model we sought was a Logistic Regression model. With this approach we are able to identify which surrounding variables from our original data set directly impact our independent variable which in this case is fire service response time. First we filtered our cutoff point in regards to response time and ran a variable selection method to finalize the surrounding dependent variables being used in the Logistic Regression model Once we completed the variable selection process we were able to identify that the variables holding significance in correlation to response time were TotalStaffOnIncident, FireDistrict, DayOfWeek, shift, Month, and AlarmHour. When originally running this test a couple of our dependent variables had processed as one big character component not giving the model its true ability to compare all given components within that given variable. To solve this we mutated these variables as factors in order to unravel the different contents within each variables allowing the model to accurately compare each given variable to fire service response time. In return we were able to mathematically see the significance of each variable and its impact on response time as a whole.

```{r, echo=FALSE}
gso.fire.filtered = gso.fire %>%
  filter(response_time_seconds < cutoff.response_time)
```

```{r, echo=FALSE}
gso.fire.filtered = gso.fire.filtered %>% 
  mutate(AlarmHour = as.factor(AlarmHour))
  
```


```{r, echo=FALSE}
lm.res.time = lm(response_time_seconds ~ TotalStaffOnIncident + FireDistrict + DayOfWeek + shift + Month + AlarmHour, data = gso.fire.filtered)
```


```{r, echo=FALSE}
library(MASS)
lm.res.time.select = stepAIC(lm.res.time)
summary(lm.res.time.select)

```


## Conclusion

## Discussion

## Related Literature
https://www.researchgate.net/publication/316976331_Modelling_residential_fire_incident_response_times_A_spatial_analytic_approach

https://www.researchgate.net/publication/226273683_The_Relationships_Between_Fire_Service_Response_Time_and_Fire_Outcomes

https://www.researchgate.net/publication/333158843_Statistical_Analysis_of_Fire_Department_Response_Times_and_Effects_on_Fire_Outcomes_in_the_United_States

https://dl.acm.org/doi/abs/10.1145/3523286.3524560

https://dl.acm.org/doi/10.5555/3091125.3091154

https://ieeexplore.ieee.org/document/9060320

https://ieeexplore.ieee.org/abstract/document/7046087

## Appendix
This section contains the code to reproduce the analysis described in this report.

Below is a list of the libraries that we used throughout the report.

#### Loading necessary packages

```{r, message=FALSE, warning=FALSE, eval=FALSE}
library(readr)
library(lubridate)
library(ggplot2)
library(dslabs)
library(dplyr)
library(ggrepel)
library(ggthemes)
library(broom)
```

#### Data Preprocessing
```{r, message=FALSE, warning=FALSE, eval=FALSE}
gso.fire <- read_csv("Greensboro_Fire_Incidents.csv")
```


#### Filtering for incidents prior to June 1st 2022
```{r, eval=FALSE}
gso.fire = 
  gso.fire %>%
  mutate(AlarmDate2 = make_date(Year, Month, Day)) %>%
  filter(AlarmDate2 < '2022-06-01')
```

#### Filter for property type 1-2 family dwellings
```{r, eval=FALSE}
gso.fire = gso.fire %>%
  filter(PropertyUse == '419 - 1 or 2 family dwelling')
```

#### Convert to call process time to seconds and add to gso.fire
```{r, eval=FALSE}
gso.fire = gso.fire %>%
  mutate(call_process_period = lubridate::hms(CallProcessingTime), 
         call_process_seconds = period_to_seconds(call_process_period))
```

#### Convert response time to seconds and add to gso.fire
```{r, message=FALSE, warning=FALSE, eval=FALSE}
gso.fire = gso.fire %>%
  mutate(response_time_period = lubridate::hms(ResponseTime),
         response_time_seconds = period_to_seconds(response_time_period))
```

#### Convert total response time to seconds and add to gso.fire
```{r, message=FALSE, warning=FALSE, eval=FALSE}
gso.fire = gso.fire %>%
  mutate(total_response_period = lubridate::hms(TotalResponseTime),
         total_response_seconds = period_to_seconds(total_response_period))
```

#### Cutoff point for response time
```{r, eval=FALSE}
cutoff.response_time = gso.fire %>% select(response_time_seconds) %>%
  filter(!is.na(response_time_seconds)) %>%
  summarize(c = quantile(response_time_seconds, .75) + 3 * IQR(response_time_seconds)) %>%
  pull(c)
```

### Univariate graphs

```{r, message=FALSE, warning=FALSE, eval=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = response_time_seconds, fill = "red")) +
  geom_histogram(show.legend = FALSE, color = "black") +
  xlab("Response Time (Seconds)") +
  ylab("Count") +
  ggtitle("Distribution of Response Time") +
  theme_economist()
```


```{r, eval=FALSE}
gso.fire %>%
  ggplot(aes(x = AlarmHour)) +
  geom_bar(color = "black", fill = "pink") +
  scale_x_continuous(breaks = seq(0,23,1)) +
  theme(axis.text.x = element_text(angle = 45)) +
  xlab("Alarm Hour") +
  ylab("Count") +
  ggtitle("Frequency of Fire Alarms by Alarm Hour")
```


```{r, eval=FALSE}
gso.fire %>%
  count(station) %>%
  mutate(station = reorder(station, n)) %>%
  ggplot(aes(x = station, y = n)) +
  geom_bar(stat = "identity", color = "black", fill = "pink") +
  theme(axis.text.y = element_text(size = 6)) +
  xlab("Fire Station (Station Number)") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Fire Station") +
  coord_flip()
```


```{r, eval=FALSE}
gso.fire %>%
  count(FireDistrict) %>%
  mutate(FireDistrict = reorder(FireDistrict, n)) %>%
  ggplot(aes(x = FireDistrict, y = n)) +
  geom_bar(stat = "identity", color = "black", fill = "pink") +
  theme(axis.text.y = element_text(size = 6)) +
  xlab("Fire Station (Station Number)") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Fire District") +
  coord_flip()
```


```{r, eval=FALSE}
gso.fire %>%
  count(Year) %>%
  ggplot(aes(x = Year, y = n)) +
  geom_bar(stat = "identity", fill = "pink", color = "black") +
  scale_x_continuous(breaks = seq(2010,2022,1)) +
  xlab("Year") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Year")
```


```{r, eval=FALSE}
gso.fire %>%
  ggplot(aes(x = shift)) +
  geom_bar(show.legend = FALSE, fill = "pink", color = "black") +
  xlab("Shift") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Shift")
```


```{r, eval=FALSE}
gso.fire %>%
  ggplot(aes(x = DayOfWeek)) +
  geom_bar(fill = "pink", color = "black") +
  xlab("Days of the Week") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Days of the Week")
```


```{r, eval=FALSE}
gso.fire %>%
  ggplot(aes(x = Week)) +
  geom_bar(fill = "pink", color = "black") +
  scale_x_continuous(breaks = seq(1,53,1)) +
  theme(axis.text.x = element_text(angle = 90)) +
  xlab("Week") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Week")
```


```{r, eval=FALSE}
gso.fire %>%
  ggplot(aes(x = Month)) +
  geom_bar(fill = "pink", color = "black") +
  xlab("Month") +
  ylab("Count") +
  ggtitle("Frequency of Calls by Month")
```

### Bivariate Graphs

```{r, eval=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = Week, y = response_time_seconds, group = Week)) +
  geom_boxplot() +
  scale_x_continuous(breaks = seq(1,53,1)) +
  theme(axis.text.x = element_text(angle = 90)) +
  xlab("Week") +
  ylab("Response Time (Seconds)") +
  ggtitle("Week vs Response Time")
```


```{r, eval=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = station, y = response_time_seconds)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90)) +
  xlab("Station") +
  ylab("Response Time (Seconds)") +
  ggtitle("Station vs Response Time")
```


```{r, eval=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = NatureCode, y = response_time_seconds)) +
  theme(axis.text.x = element_text(angle = 90)) +
  geom_boxplot() +
  xlab("Nature Code") +
  ylab("Response Time (Seconds)") +
  ggtitle("Nature Code vs Response Time")
```


```{r, eval=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = response_time_seconds, y = TotalStaffOnIncident)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Total Staff On Incident") +
  xlab("Response Time (Seconds)") +
  ggtitle("Total Staff on Incident vs Response Time") +
  theme_economist()
```


```{r, eval=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = response_time_seconds, y = CivilianInjuries)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Civilian Injuries") +
  xlab("Response Time (Seconds)") +
  ggtitle("Civilian Injuries vs Response Time") +
  theme_economist() 
```


```{r, eval=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = response_time_seconds, y = CivilianFatalities)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Civilian Fatalities") +
  xlab("Response Time (Seconds)") +
  ggtitle("Civilian Fatalities vs Response Time") + 
  theme_economist()
```


```{r, eval=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = response_time_seconds, y = FireServiceInjuries)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Fire Service Injuries") +
  xlab("Response Time (Seconds)") +
  ggtitle("Fire Service Injuries Injuries vs Response Time") +
  theme_economist()
```


```{r, eval=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = response_time_seconds, y = FireServiceFatalities)) +
  geom_point(stat = "identity", show.legend = FALSE) +
  ylab("Fire Service Fatalities") +
  xlab("Response Time (Seconds)") +
  ggtitle("Fire Service Fatalities vs Response Time") +
  theme_economist() 
```


```{r, eval=FALSE}
gso.fire %>%
  filter(!is.na(response_time_seconds)) %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = DayOfWeek, y = response_time_seconds)) +
  geom_violin(trim = FALSE, fill = "light blue") +
  geom_boxplot(width = 0.3, fill = "pink") +
  xlab("Days of the Week") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin & Box Plot of Response Time Densities by Days of the Week") +
  theme(axis.text.x = element_text(angle = 90), legend.position = "hide")
```


```{r, eval=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = Year, y = response_time_seconds, group = Year)) +
  geom_violin(trim = FALSE, fill = "light blue") +
  geom_boxplot(show.legend = FALSE, width = .3, fill = "pink") +
  scale_x_continuous(breaks = seq(2010,2022,1)) +
  xlab("Year") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin & Box Plot of Response Time Densities by Year")
```


```{r, eval=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = shift, y = response_time_seconds)) +
  geom_violin(show.legend = FALSE, fill = "light blue") +
  geom_boxplot(width = .5, show.legend = FALSE, fill = "pink") +
  xlab("Work shift") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin and Box Plot of Response Time Densities by Work Shift")
```


```{r, message=FALSE, warning=FALSE, eval=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = FireDistrict, y = response_time_seconds)) +
  geom_violin(fill = "light blue") +
  geom_boxplot(show.legend = FALSE, width = .2, fill = "pink") +
  theme(axis.text.x = element_text(angle = 90), legend.position = "hide") +
  xlab("Fire District") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin and Box Plot of Response Time Densities by Fire District")
```


```{r, eval=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = Month, y = response_time_seconds)) +
  geom_violin(show.legend = FALSE, fill = "light blue") +
  geom_boxplot(show.legend = FALSE, width = .3, fill = "pink") +
  xlab("Month") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin and Box Plot of Response Time Densities by Month")
```


```{r, eval=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = AlarmHour, y = response_time_seconds, group = AlarmHour)) +
  geom_violin(fill = "light blue") +
  geom_boxplot(width = .3, fill = "pink") +
  scale_x_continuous(breaks = seq(0,23,1)) +
  xlab("Alarm Hour") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin and Box Plot of Response Time Densities by Alarm Hour")
```


```{r, message=FALSE, warning=FALSE, eval=FALSE}
gso.fire %>%
  filter(response_time_seconds < cutoff.response_time) %>%
  ggplot(aes(x = NumberOfAlarms, y = response_time_seconds, group = NumberOfAlarms)) +
  geom_violin(fill = "light blue") +
  geom_boxplot(width = .3, fill = "pink") +
  xlab("Number of Alarms") +
  ylab("Response Time (Seconds)") +
  ggtitle("Violin and Box Plot of Response Time Densities by Number of Alarms")
```

### Time Series Visualization

```{r, eval=FALSE}
gso.fire.ts = gso.fire %>%
  count(AlarmDate2)
```


```{r, eval=FALSE}
gso.fire.ts %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Year") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents")
```


```{r, eval=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2010-01-01" & AlarmDate2 <= "2010-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2010")
```


```{r, eval=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2011-01-01" & AlarmDate2 <= "2011-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2011")
```


```{r, eval=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2012-01-01" & AlarmDate2 <= "2012-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2012")
```


```{r, eval=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2013-01-01" & AlarmDate2 <= "2013-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2013")
```


```{r, eval=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2014-01-01" & AlarmDate2 <= "2014-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2014")
```


```{r, eval=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2015-01-01" & AlarmDate2 <= "2015-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2015")
```


```{r, eval=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2016-01-01" & AlarmDate2 <= "2016-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2016")
```


```{r, eval=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2017-01-01" & AlarmDate2 <= "2017-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2017")
```


```{r, eval=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2018-01-01" & AlarmDate2 <= "2018-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2018")
```


```{r, eval=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2019-01-01" & AlarmDate2 <= "2019-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2019")
```


```{r, eval=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2020-01-01" & AlarmDate2 <= "2020-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2020")
```


```{r, eval=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2021-01-01" & AlarmDate2 <= "2021-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2021")
```


```{r, eval=FALSE}
gso.fire.ts %>%
  filter(AlarmDate2 >= "2022-01-01" & AlarmDate2 <= "2022-12-31") %>%
  ggplot(aes(x = AlarmDate2, y = n)) +
  geom_line() +
  xlab("Alarm Date") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of daily number of fire incidents for 2022")
```


```{r, eval=FALSE}
gso.fire.ts.week = gso.fire %>%
  mutate(Weekly = make_date(Year, Week)) %>%
  group_by(Weekly, Year, Week) %>%
  count()
```


```{r, eval=FALSE}
gso.fire.ts.week %>%
  ggplot(aes(Weekly, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2010-2022")
```


```{r, eval=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2010") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2010")
```


```{r, eval=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2011") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2011")
```


```{r, eval=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2012") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2012")
```


```{r, eval=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2013") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2013")
```


```{r, eval=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2014") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2014")
```


```{r, eval=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2015") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2015")
```


```{r, eval=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2016") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2016")
```


```{r, eval=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2017") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2017")
```


```{r, eval=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2018") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2018")
```


```{r, eval=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2019") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2019")
```


```{r, eval=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2020") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2020")
```


```{r, eval=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2021") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2021")
```


```{r, eval=FALSE}
gso.fire.ts.week %>%
  filter(Year == "2022") %>%
  ggplot(aes(x = Week, y = n)) +
  geom_line() +
  xlab("Week") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of weekly number of fire incidents for 2022")
```


```{r, eval=FALSE}
gso.fire.ts.month = gso.fire %>%
  mutate(Monthly = make_date(Year, Month)) %>%
  group_by(Monthly, Month, Year) %>%
  count()
```


```{r, eval=FALSE}
gso.fire.ts.month %>%
  ggplot(aes(x = Monthly, y = n)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2010-2022")
```


```{r, eval=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2010") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2010")
```


```{r, eval=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2011") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2011")
```


```{r, eval=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2012") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2012")
```


```{r, eval=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2013") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2013")
```


```{r, eval=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2014") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2014")
```


```{r, eval=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2015") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2015")
```


```{r, eval=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2016") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2016")
```


```{r, eval=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2017") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2017")
```


```{r, eval=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2018") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2018")
```


```{r, eval=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2019") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2019")
```


```{r, eval=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2020") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2020")
```


```{r, eval=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2021") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2021")
```


```{r, eval=FALSE}
gso.fire.ts.month %>%
  filter(Year == "2022") %>%
  ggplot(aes(x = Month, y = n, group = 1)) +
  geom_line() +
  xlab("Month") +
  ylab("Number of Fire Incidents") +
  ggtitle("Time series of monthly number of fire incidents for 2022")
```